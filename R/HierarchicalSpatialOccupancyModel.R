#A hierarchical spatial occupancy model based on MacKenzie et al. (2002. Estimating
#site occupancy rates when detection probabilities are less than 1. Ecology 83:2248-2255). 
#In the code below we have taken a sequential approach to the analysis of the detection data.
model{
  #Below, model the spatial random effects (w[i] for occupancy and v[i] for detection probability) centered at zero.
  W[1:Nplot] ~ spatial.exp(Zero[1:Nplot], East[], North[], Tau[1], alpha[1], gamma[1]) 
  V[1:Nplot] ~ spatial.exp(Zero[1:Nplot], East[], North[], Tau[2], alpha[2], gamma[2]) 	
  for(i in 1:Nplot){		
    Zero[i] <- 0
    w[i] <- Xi[1]*W[i]	#Use parameter expansion for the random effects for better mixing.
    v[i] <- Xi[2]*V[i]
  }
  for(i in 1:2){		
    alpha[i] ~ dunif(0,100) 	#Prior for the rate of decline in correlation with increasing distance.	
    gamma[i] <- 1 	#Gamma controls the amount of spatial smoothing. Since it's difficult to estimate we've set it to a standard.
  }
  
  for(i in 1:nObs){	#Model the random observer effects d[i] for detection probability.
    D[i] ~ dnorm(0,Tau[3]) 	
    d[i] <- Xi[3]*D[i]	
  }
  
  for(i in 1:Nplot){	#Link the linear combination for occupancy probability to psi with the logit link. 	
    psi[i] <- 1/(1+exp(-(  Beta[1] + Beta[2]*Z[Plot[i]] + w[Plot[i]] )))
  }
  for(i in 1:Nsubplot){
    #pR = probability of at least one detection at site i among all searches 1 to T.	
    pR[i] <- psi[Plot[i]]*(1-exp(sum(lq[i, 1:T])))	#Use exp(sum(log(f))) in lieu of a product(f) function.
    for(t in 1:T){			#cycle through the search occasions
      lq[i,t] <- log(1-p[i,t])
      #link the linear combination for detection probability to p with the logit link.
      p[i,t] <- 1/(1+exp(-(   Beta[3] + Beta[4]*Z[Plot[i]] + v[Plot[i]] + d[Obs[i, t]])))
    }
  }
  for(i in 1:Nsubplot){
    R[i] ~ dbern(pR[i])	#Model the statistic R[i]. R[i] = 1 if a detection was made at site i, or R[i] = 0 if no detection was made.
    #pX[i,t] is the probability of a detection at site i at time t given R. 
    #pX[i,t] = R[i]*p[i,t]/(1-prod(q[i,t:T])) for t = 1, and 
    #pX[i,t] = R[i]*p[i,t]/(1-prod(q[i,t:T])*I(sum(X[i,1:t-1]) = 0)) for t in 2 to T, where I() is an indicator function for the equality.
    #Or by introducing the statistic myt[i] it can be done with the single loop below.
    #myt[i] is the first occasion detected at site i or T+1 if no detections were made at site i.
    for(t in 1:T){
      pX[i,t] <- R[i]*p[i,t]/(1-exp(sum(lq[i,t:T]))*step(myt[i]-t))  
      X[i,t] ~ dbern(pX[i,t])	
    }
  }	
  
  psi.bar ~ dunif(0,1)		#uniform prior on probability scale for the psi intercept
  Beta[1] <- log(psi.bar/(1-psi.bar))
  Beta[2] ~ dnorm(0,1.0E-4)	#prior for the coefficient of the covariate Z for occupancy probability.
  p.bar ~ dunif(0,1)		#uniform prior on probability scale for the p intercept
  Beta[3] <- log(p.bar/(1-p.bar))
  Beta[4] ~ dnorm(0,1.0E-4)	#prior for the coefficient of the covariate Z for capture probability.
  
  #Below, use the hierarchical half-Cauchy prior for random effect standard deviations from Gelman (2006. Prior distributions
  #for variance parameters in hierarchical models (Comment on article by Brown and Draper). Bayesian Analysis 3:515-534). 
  for(i in 1:4){		
    Xi[i] ~ dnorm(0,Tau.xi[i])	
    Tau.xi[i] <- pow(Sig.xi[i],-2) 
    Sig.xi[i] <- u	#Cauchy scale parameter u is estimated from the data.
    Tau[i] ~ dgamma(0.5,0.5)		
    Sig[i] <- abs(Xi[i])/sqrt(Tau[i])		
  }
  u ~ dunif(0,3)	#Prior for the Cauchy scale parameter.
}

Simulated data
list(Nsubplot=400,Nplot=50,T=5,nObs=10,
     X=structure(.Data=c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,1,0,1,1,0,0,1,0,1,0,0,0,0,0,0,1,1,1,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,1,0,1,1,1,1,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,1,0,1,0,0,0,0,0,0,0,0,1,1,1,0,0,1,0,0,0,0,1,1,0,1,1,1,0,1,1,0,1,1,1,1,1,1,1,0,0,0,0,0,1,1,0,1,0,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,1,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,1,1,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,1,0,0,1,1,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,1,1,1,0,1,0,1,1,0,0,1,1,0,1,1,1,1,1,0,1,0,0,0,0,0,1,1,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),.Dim=c(400,5)),
                         R=c(0,0,0,0,0,0,0,1,1,1,0,1,1,1,0,0,1,0,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,1,0,0,1,0,0,0,0,0,1,0,0,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,0,1,0,1,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,1,1,0,1,1,1,1,1,1,0,1,1,0,0,0,0,0,0,1,0,0,1,1,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,0,1,0,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,1,0,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,0,0,1,0,0,1,0,1,1,1,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,1,1,1,1,0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0),
                         Obs=structure(.Data=c(10,5,5,1,3,3,9,3,9,7,4,6,4,6,7,10,9,10,6,10,3,4,8,6,4,2,4,2,8,5,4,1,6,8,1,6,2,8,1,2,10,1,3,6,4,8,2,2,7,1,9,8,7,8,2,2,10,8,6,4,7,9,5,4,8,3,5,10,1,7,8,4,10,6,10,3,2,4,7,3,4,4,1,7,1,3,7,2,3,5,7,6,1,7,3,4,5,9,1,3,2,10,4,1,7,10,3,9,6,4,3,2,9,8,8,9,1,3,5,1,2,7,2,3,5,3,2,10,7,4,9,4,8,8,1,4,8,6,2,2,10,9,10,2,9,3,10,4,2,4,4,2,2,8,10,8,4,10,6,9,2,10,6,4,4,6,7,1,7,2,7,4,6,3,10,6,5,6,3,1,7,5,5,10,4,6,4,5,4,2,2,5,5,8,3,1,5,8,2,5,2,6,2,3,9,10,10,6,8,7,7,3,9,5,6,1,6,7,4,1,6,7,7,8,2,7,9,3,2,7,10,4,6,2,2,2,2,10,3,10,6,7,10,10,5,3,10,4,9,3,4,2,7,8,9,7,2,2,7,2,10,8,8,10,7,6,10,2,7,10,2,1,6,8,6,8,6,7,5,5,10,8,1,3,7,5,10,3,2,3,7,7,6,10,2,10,10,3,3,6,9,1,1,4,8,9,7,10,1,7,8,9,3,10,2,3,8,7,1,3,4,2,6,1,4,6,3,3,2,3,1,10,3,5,2,3,7,6,3,1,9,6,8,9,10,7,1,1,6,7,5,9,10,7,2,10,10,7,4,1,5,8,6,3,5,9,6,4,4,4,9,6,1,8,9,4,2,6,5,9,10,9,5,10,7,4,9,1,8,9,5,5,7,1,2,2,10,4,6,5,2,4,2,4,5,9,1,10,2,4,8,2,1,1,8,5,7,1,7,9,6,9,8,9,7,10,9,2,7,5,4,4,3,7,1,2,8,3,3,2,1,3,4,10,4,8,8,1,1,5,6,9,3,8,1,10,9,5,3,7,7,5,9,6,5,7,8,10,9,7,8,1,4,7,5,7,2,5,2,8,3,6,8,3,9,4,5,10,7,5,5,9,4,10,10,3,10,5,9,7,10,9,1,7,6,10,6,3,9,6,9,9,10,3,3,7,9,2,8,3,5,7,9,7,4,6,9,5,10,6,3,4,3,6,5,5,5,6,9,6,3,6,8,6,6,10,4,6,7,3,9,10,2,7,3,10,7,9,8,7,3,10,3,4,4,8,10,10,9,5,6,2,2,3,2,10,3,3,4,5,1,5,5,4,10,9,10,10,1,6,9,9,8,10,5,10,2,5,1,5,8,8,7,4,1,8,4,6,1,9,6,3,2,2,7,8,3,7,3,9,2,8,1,6,7,8,4,5,3,1,6,1,3,1,8,9,3,8,6,3,2,8,10,10,3,8,2,6,7,6,8,2,5,6,5,8,4,5,6,10,7,7,8,6,7,8,4,6,4,1,10,7,9,3,6,5,4,2,3,8,7,6,9,6,5,8,1,2,8,4,6,8,2,3,8,9,7,3,6,1,9,4,8,9,6,9,10,10,10,7,8,2,7,4,9,1,9,4,8,4,2,3,10,7,2,8,2,10,6,3,9,10,5,7,10,2,3,10,8,6,10,4,1,8,10,6,10,9,9,3,8,4,2,6,3,10,2,7,7,5,8,2,6,6,4,10,8,4,2,10,3,3,10,5,7,7,1,9,9,5,8,4,2,9,9,9,3,7,10,1,10,8,2,10,2,3,4,3,1,4,5,6,8,7,5,7,8,7,6,2,8,9,1,5,7,8,9,10,3,5,1,8,1,2,3,9,7,4,2,7,8,3,2,3,10,5,6,9,4,5,2,3,6,9,7,3,8,4,3,10,5,6,2,8,1,8,1,9,1,10,2,7,8,4,1,9,4,9,4,7,9,7,8,3,2,7,7,9,4,5,2,4,1,9,8,7,3,4,7,7,4,4,10,6,3,10,6,10,7,5,3,1,1,10,8,4,1,1,10,1,1,5,7,6,8,2,10,4,7,4,8,1,9,10,3,4,10,3,1,1,5,6,10,9,10,7,3,9,8,5,3,3,7,4,1,3,10,4,4,3,8,3,5,9,1,8,1,8,4,3,5,8,8,9,3,2,6,9,8,8,6,10,7,10,10,4,9,7,3,8,1,9,5,5,8,4,1,8,7,3,6,2,1,1,7,3,2,7,6,9,10,2,4,3,5,4,6,10,1,8,6,8,7,9,8,9,5,3,10,5,1,7,1,4,2,8,8,7,5,5,1,9,5,4,8,8,3,6,10,9,1,4,3,6,6,3,7,9,10,9,7,1,5,9,9,2,10,7,5,2,8,6,10,8,4,9,1,4,4,4,4,5,4,10,2,9,4,7,6,6,2,8,8,8,1,2,4,5,6,2,9,5,1,8,1,5,10,3,9,2,2,2,3,4,8,3,5,6,9,7,4,9,8,1,2,3,8,5,10,6,5,9,8,2,10,7,3,3,8,10,9,9,6,3,6,5,10,4,4,1,4,8,9,5,4,6,3,6,8,9,10,6,5,9,7,1,6,8,7,10,6,7,5,9,6,10,4,5,3,10,10,5,7,3,10,5,7,8,3,8,3,4,10,1,9,1,2,10,4,1,2,4,1,10,10,4,10,2,1,2,10,5,7,1,7,8,1,2,7,8,9,8,8,1,10,8,1,5,7,1,10,1,1,2,8,10,7,2,3,9,5,4,9,10,4,1,7,1,10,4,10,10,9,9,4,8,3,8,7,7,1,5,2,9,3,4,2,3,3,7,8,9,3,9,9,3,2,9,2,3,10,10,3,4,10,7,2,1,2,1,1,10,10,1,5,5,10,5,9,2,5,9,6,8,8,5,8,7,1,3,5,6,10,8,8,1,6,2,2,4,1,1,8,8,10,6,3,7,2,9,8,8,8,3,8,3,9,3,6,10,6,3,2,3,2,1,1,1,6,6,2,8,9,10,10,7,3,6,2,10,3,3,6,1,4,2,10,4,9,2,5,7,6,2,10,10,7,3,4,9,6,10,10,9,1,8,1,5,5,4,7,1,2,8,7,10,2,2,6,1,10,7,6,4,1,2,5,6,9,3,4,10,10,1,10,7,7,2,2,3,6,3,9,9,7,2,10,10,1,6,8,6,8,1,6,2,4,4,2,1,10,7,6,6,9,7,4,10,10,2,7,3,3,8,4,6,4,6,2,7,9,8,5,8,1,8,7,8,1,4,4,6,10,7,9,10,10,2,2,5,4,9,3,6,8,2,8,10,8,1,5,2,4,3,7,2,5,4,8,5,3,7,5,4,10,10,4,9,5,8,3,10,8,1,5,1,3,1,2,2,1,7,3,8,8,7,6,3,1,7,10,1,4,1,3,7,2,8,1,8,8,10,4,4,9,10,10,5,5,4,3,9,5,3,9,9,6,7,10,9,3,9,3,4,3,10,1,4,3,8,3,2,4,5,5,1,1,7,1,10,3,4,5,10,8,1,2,8,10,3,9,10,3,3,1,5,6,8,4,4,8,10,9,6,4,5,2,5,9,10,9,9,9,1,4,7,3,7,6,7,1,3,9,10,3,6,10,4,6,6,10,1,8,6,7,2,1,1,10,8,6,6,3,3,6,10,5,6,2,2,5,4,9,4,1,5,8,4,8,7,7,2,10,6,4,1,10,6,8,9,5,10,10,10,10,6,9,10,8,5,7,6,8,6,7,10,4,2,7,2,7,7,8,5,1,2,7,10,3,5,1,7,8,5,2,8,7,9,10,5,4,7,5,3,9,1,3,5,1,3,6,4,2,4,4,3,5,1,4,6,5,5,9,9,10,6,10,4,3,1,6,4,4,6,2,3,4,1,2,10,10,7,1,6,9,4,1,7,3,9,2,10,2,9,2,9,4,2,2,10,7,5,1,2,6,8,9,7,3,10,10,3,10,1,6,3,5,6,4,7,6,7,2,8,4,10,1,6,8,4,2,4,2,8,4,7,9,1,10,10,10,5,4,5,8,4,6,3,10,10,4,5,6,4,4,3,1,8,9,1,6,1,1,1,10,8,10,7,7,5,8,6,2,7,5,1,7,2,3,4,10,4,10,7,1,8,7,3,3,4,4,9,3,1,1,7,2,10,7,5,9,10,1,8,7,7,2,6,4,6,10,9,8,3,8,3,9,8,3,3,1,3,10,7,2,6,9,7,10,1,1,8,1,6,4,1,5,7,7,3,1,3,9,3,10,5,4,8,4,8,6,3,6,8,6,7,5,5,4,9,1,5,7,4,3,9,1,6,8,10,1,7,4,5,7,9,1,3,6,9,2,4,4,5,10,3,5,10,6,6,3,8,6,2,3,8,4,1,7,1,2,6,7,9,5,8,6,9,4,10,7,6,10,4,2,7,1,5,3,1,3,7,10,1,7,10,9,6,8,8,3,3,9,2,9,6,6,9,8,5),.Dim=c(400,5)),
                                               myt=c(10,10,10,10,10,10,10,3,2,3,10,2,4,2,10,10,2,10,10,10,10,1,10,1,10,10,10,10,10,10,10,10,10,10,3,1,2,10,2,10,10,2,10,10,10,10,10,1,10,10,10,3,2,10,10,4,10,10,10,10,10,10,10,10,10,1,10,10,10,10,3,10,10,10,10,10,10,10,10,10,10,2,10,10,10,3,10,10,10,10,4,10,1,10,10,2,10,10,10,10,10,10,10,10,10,5,10,10,3,1,10,4,1,4,2,1,1,10,1,1,10,10,10,10,10,10,1,10,10,1,1,10,10,10,10,10,10,10,5,10,10,10,10,3,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,4,10,10,10,10,10,5,10,10,1,10,10,1,10,10,1,2,10,10,10,5,10,4,5,10,10,4,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,1,10,2,10,1,10,10,10,10,10,10,10,10,5,10,4,5,10,1,1,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,1,10,10,10,10,1,10,10,10,10,10,10,10,10,10,10,10,2,10,10,10,10,5,10,10,10,10,10,10,3,10,10,10,10,10,10,10,3,10,10,10,10,10,10,10,10,10,10,10,10,10,10,1,10,2,2,10,10,4,10,10,2,10,3,1,1,10,10,10,1,10,10,10,10,4,10,10,10,10,10,1,1,2,1,1,10,1,10,10,4,10,10,10,10,10,10,1,10,10,10,1,10,2,10,10,10,10,10,10,10,10,10,10,4,2,4,10,10,10,4,10,10,10,10,10,1,10,10,10,10,3,10,10,10,10,1,10,10,10,10,10,10,10,10,2,10,10,10,10,10,10),
                                               Z=c(-0.792,0.637,1.135,0.255,-0.28,-0.797,-0.919,-0.02,0.743,1.557,-0.464,0.13,0.236,-0.727,0.434,0.631,-0.774,-1.035,0.376,-0.983,-0.857,-0.367,-0.28,-1.672,-0.118,1.475,0.572,0.277,-0.523,0.545,0.144,0.785,0.531,-0.491,-0.296,0.084,0.621,1.114,-0.735,-0.71,0.193,0.898,-0.352,-0.441,1.145,-2.601,-0.936,-2.682,0.327,-0.782),
                                               Plot=c(1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50),
                                               East=c(0.324204560834914,0.631038189865649,0.572854856494814,0.940745499450713,0.889039656613022,0.839173746760935,0.461630376521498,0.826352179050446,0.00861150398850441,0.705468433909118,0.246500398498029,0.197834366932511,0.593870905227959,0.229943682439625,0.487553666811436,0.823107164353132,0.807010096497834,0.244231397286057,0.356660059653223,0.844263121951371,0.437722022179514,0.843207285739481,0.869866993278265,0.502964056096971,0.768202072940767,0.475797943770885,0.836645741481334,0.652219695039093,0.7663254882209,0.955900229513645,0.0904659745283425,0.982387942261994,0.404074235353619,0.175281514413655,0.0251329322345555,0.947795838583261,0.424414549022913,0.839535528793931,0.186114921700209,0.284105363301933,0.343747769482434,0.970363398082554,0.726596567314118,0.855520991142839,0.560243720188737,0.69608999742195,0.353520698379725,0.96075353724882,0.959716750308871,0.735647318419069),
                                               North=c(0.0384965632110834,0.678358974866569,0.527232892811298,0.497661717236042,0.6877974960953,0.330357737373561,0.0106287766247988,0.818838845938444,0.620063500013202,0.809061062987894,0.480055637657642,0.172368965111673,0.400551012717187,0.0940145230852067,0.402150592766702,0.0253195185214281,0.210046959109604,0.691787303891033,0.739815418608487,0.318655936978757,0.7277124482207,0.495117714628577,0.663628224749118,0.143117761239409,0.845508828293532,0.364775269292295,0.305535820778459,0.910344737116247,0.70426281215623,0.849430910777301,0.687324491795152,0.392128500621766,0.971747070550919,0.135316719301045,0.241754229646176,0.548351630568504,0.658685945905745,0.398282038979232,0.608832554891706,0.578017645981163,0.0898327301256359,0.466882796026766,0.580382448621094,0.751898750197142,0.26252488931641,0.666763929650187,0.864720492158085,0.176187402103096,0.140384873840958,0.920476893428713))
                                       
                                       Initial values
                                       list(Beta=c(NA,0,NA,0),
                                            D = c(0,0,0,0,0,0,0,0,0,0),
                                            Tau = c(1,1,1,1),
                                            Xi=c(0,0,0,0),
                                            p.bar=0.5,
                                            psi.bar=0.5,
                                            W=c(
                                              0,0,0,0,0,0,0,0,0,0,
                                              0,0,0,0,0,0,0,0,0,0,
                                              0,0,0,0,0,0,0,0,0,0,
                                              0,0,0,0,0,0,0,0,0,0,
                                              0,0,0,0,0,0,0,0,0,0),
                                            V=c(
                                              0,0,0,0,0,0,0,0,0,0,
                                              0,0,0,0,0,0,0,0,0,0,
                                              0,0,0,0,0,0,0,0,0,0,
                                              0,0,0,0,0,0,0,0,0,0,
                                              0,0,0,0,0,0,0,0,0,0),
                                            alpha=c(25,25),
                                            u=1)
                                       
                                       
                                       
                                       Population parameter values
                                       W=c(-1.116,1.182,1.716,-0.645,0.021,-0.83,-0.368,-1.478,1.307,-1.698,-0.249,0.815,0.121,0.419,1.27,-0.655,-1.871,-1.073,-0.958,-1.025,-0.451,-0.315,0.386,0.408,-1.637,0.538,-0.803,-0.141,2.328,-1.83,-0.675,0.089,-1.702,-0.55,-0.261,0.238,-0.291,1.21,-1.602,0.25,-0.937,1.685,-1.972,-0.967,0.563,0.06,-1.295,-0.006,0.806,-1.645),
                                       V=c(-0.169,-0.038,0.044,0.083,0.088,-0.096,-0.148,0.143,0.088,-0.1,-0.044,-0.073,-0.241,0.059,0.051,0.229,0.007,0.059,0.042,-0.1,-0.222,0.008,-0.052,0.072,0.083,0.068,-0.177,-0.119,-0.084,0.12,0.069,0.036,0.029,-0.082,0.033,-0.09,0.029,-0.01,0.037,-0.062,0.04,-0.052,0.008,-0.073,-0.197,0.02,-0.16,0.065,-0.018,-0.024),
                                       Beta=c(-1,-1,0,1),
                                       d=c(0.282603872538261,0.0462689854552268,0.0388281662867744,0.241531860550676,0.26885150542174,0.191875493835539,-0.806778901138745,-0.371108798274344,-0.673606805049748,-0.0970034043613841),
                                       sig=c(1,0.1,0.3,0.2),
                                       alpha=25,
                                       x=c(0.324204560834914,0.631038189865649,0.572854856494814,0.940745499450713,0.889039656613022,0.839173746760935,0.461630376521498,0.826352179050446,0.00861150398850441,0.705468433909118,0.246500398498029,0.197834366932511,0.593870905227959,0.229943682439625,0.487553666811436,0.823107164353132,0.807010096497834,0.244231397286057,0.356660059653223,0.844263121951371,0.437722022179514,0.843207285739481,0.869866993278265,0.502964056096971,0.768202072940767,0.475797943770885,0.836645741481334,0.652219695039093,0.7663254882209,0.955900229513645,0.0904659745283425,0.982387942261994,0.404074235353619,0.175281514413655,0.0251329322345555,0.947795838583261,0.424414549022913,0.839535528793931,0.186114921700209,0.284105363301933,0.343747769482434,0.970363398082554,0.726596567314118,0.855520991142839,0.560243720188737,0.69608999742195,0.353520698379725,0.96075353724882,0.959716750308871,0.735647318419069),
                                       y=c(0.0384965632110834,0.678358974866569,0.527232892811298,0.497661717236042,0.6877974960953,0.330357737373561,0.0106287766247988,0.818838845938444,0.620063500013202,0.809061062987894,0.480055637657642,0.172368965111673,0.400551012717187,0.0940145230852067,0.402150592766702,0.0253195185214281,0.210046959109604,0.691787303891033,0.739815418608487,0.318655936978757,0.7277124482207,0.495117714628577,0.663628224749118,0.143117761239409,0.845508828293532,0.364775269292295,0.305535820778459,0.910344737116247,0.70426281215623,0.849430910777301,0.687324491795152,0.392128500621766,0.971747070550919,0.135316719301045,0.241754229646176,0.548351630568504,0.658685945905745,0.398282038979232,0.608832554891706,0.578017645981163,0.0898327301256359,0.466882796026766,0.580382448621094,0.751898750197142,0.26252488931641,0.666763929650187,0.864720492158085,0.176187402103096,0.140384873840958,0.920476893428713)